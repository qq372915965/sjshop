
//这个函数是必须的，因为在geo.js里每次更改地址时会调用此函数
function promptinfo()
{
    var address = document.getElementById('address');
    var w1 = document.getElementById('w1');
    var w2 = document.getElementById('w2');
    var w3 = document.getElementById('w3');
    address.value = w1.value + w2.value + w3.value;
}

function Dsy() {
    this.Items = {};
}
Dsy.prototype.add = function (id, iArray) {
    this.Items[id] = iArray;
}
Dsy.prototype.Exists = function (id) {
    if (typeof(this.Items[id]) == "undefined") return false;
    return true;
}

function change(v) {
    var str = "0";
    for (i = 0; i < v; i++) { str += ("_" + (document.getElementById(s[i]).selectedIndex - 1));}
    ;
    var ss = document.getElementById(s[v]);
    with (ss) {
        length = 0;
        options[0] = new Option(opt0[v], opt0[v]);
        if (v && document.getElementById(s[v - 1]).selectedIndex > 0 || !v) {
            if (dsy.Exists(str)) {
                ar = dsy.Items[str];
                for (i = 0; i < ar.length; i++)options[length] = new Option(ar[i], ar[i]);
                if (v)options[0].selected = true;
            }
        }
        if (++v < s.length) {change(v);}
    }
}
function preselect(p_key) {
    //alert(p_key);
    var index;

    var wuname = new Array("ABS", "ABS/PC", "AES", "AS", "ASA", "ASA/PC", "BOPP", "CA", "COC", "COP", "CPE", "CPVC", "EAA", "EBA", "EPDM", "EPS", "EVA", "EVOH", "FEP", "GPPS");
    var cnt = wuname.length;
    //alert(cnt);
    for (i = 0; i < cnt; i++) {
        if (p_key == wuname[i]) {
            index = i;
            break;
        }
    }
    if (index < wuname.length) {
        document.getElementById(s[0]).selectedIndex = index + 1;
        change(1);
    }
}

var dsy = new Dsy();

dsy.add("0_0", ["丙烯腈/丁二烯/苯乙烯共聚物"]);
dsy.add("0_1", ["ABS与PC合金"]);
dsy.add("0_2", ["丙烯腈/乙烯/苯乙烯共聚物"]);
dsy.add("0_3", ["丙烯腈-苯乙烯树脂"]);
dsy.add("0_4", ["丙烯腈-苯乙烯-丙烯酸酯共聚物"]);
dsy.add("0_5", ["ASA与PC合金"]);
dsy.add("0_6", ["双向拉伸聚丙烯"]);
dsy.add("0_7", ["醋酸纤维素"]);
dsy.add("0_8", ["环烯烃共聚物"]);
dsy.add("0_9", ["环烯烃聚合物#光学材料"]);
dsy.add("0_10", ["氯化聚乙烯"]);
dsy.add("0_11", ["氯化聚氯乙烯"]);
dsy.add("0_12", ["乙烯－丙烯酸塑料"]);
dsy.add("0_13", ["乙烯-丙烯酸丁酯共聚物"]);
dsy.add("0_14", ["三元乙丙橡胶"]);
dsy.add("0_15", ["发泡聚苯乙烯#可发性聚苯乙烯"]);
dsy.add("0_16", ["乙烯-醋酸乙烯共聚物"]);
dsy.add("0_17", ["乙烯－乙烯醇塑料"]);
dsy.add("0_18", ["全氟塑料"]);
dsy.add("0_19", ["通用聚苯乙烯#透苯#透明聚苯乙烯"]);
dsy.add("0", ["ABS", "ABS/PC", "AES", "AS", "ASA", "ASA/PC", "BOPP", "CA", "COC", "COP", "CPE", "CPVC", "EAA", "EBA", "EPDM", "EPS", "EVA", "EVOH", "FEP", "GPPS"]);

var s = ["w1", "w2", "w3"];
var opt0 = ["请选择", "请选择", "说明"];
function setup() {
    for (i = 0; i < s.length - 1; i++)
        document.getElementById(s[i]).onchange = new Function("change(" + (i + 1) + ");promptinfo();");
    change(0);
}

